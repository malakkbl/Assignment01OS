{% extends "base.html" %}
{% block content %}
<h1 class="title">{{algo_name}} â€“ Result</h1>

<h2 class="subtitle">Metrics</h2>
<table class="table is-bordered">
  {% for k,v in metrics.items() %}
    <tr><th>{{k.replace('_',' ').title()}}</th><td>{{"%.2f"|format(v)}}</td></tr>
  {% endfor %}
</table>

<h2 class="subtitle">Gantt Chart</h2>
<svg id="gantt" width="100%" height="{{schedule|length*30+20}}"></svg>

<script>
const schedule = {{schedule|tojson}};
const unit = 30; const barH = 20;
const svg  = document.getElementById("gantt");
schedule.forEach((seg,i)=>{
   const g = document.createElementNS("http://www.w3.org/2000/svg","g");
   const x = seg.start*unit, w = (seg.finish-seg.start)*unit, y=i*30;
   const rect = document.createElementNS(svg.namespaceURI,"rect");
   rect.setAttribute("x",x); rect.setAttribute("y",y);
   rect.setAttribute("width",w); rect.setAttribute("height",barH);
   rect.setAttribute("fill","#48c774");
   g.appendChild(rect);
   const txt = document.createElementNS(svg.namespaceURI,"text");
   txt.setAttribute("x",x+w/2); txt.setAttribute("y",y+15);
   txt.setAttribute("fill","white"); txt.setAttribute("text-anchor","middle");
   txt.textContent=seg.pid;
   g.appendChild(txt);
   svg.appendChild(g);
});
</script>
{% endblock %}
